
let number_of_glyphs = 786

let number_of_h_metrics = 719

let marshaled =
  TestUtil.make_string_even [
    (* `lmmono10-regular.otf` (offset: 0xeaac, length: 0xbc2) *)
    0x0118; 0x0000; 0x020d; 0x009d; 0x020d; 0x0017; 0x020d; 0x0021;
    0x020d; 0x00a2; 0x020d; 0x0072; 0x020d; 0x0087; 0x020d; 0x0026;
    0x020d; 0x001d; 0x020d; 0x0011; 0x020d; 0x0038; 0x020d; 0x001a;
    0x020d; 0x0015; 0x020d; 0x0020; 0x020d; 0x003a; 0x020d; 0x004a;
    0x020d; 0x001c; 0x020d; 0x000c; 0x020d; 0x001d; 0x020d; 0x0013;
    0x020d; 0x0038; 0x020d; 0x002b; 0x020d; 0x00b7; 0x020d; 0x00b4;
    0x020d; 0x0016; 0x020d; 0x0020; 0x020d; 0x0058; 0x020d; 0x001b;
    0x020d; 0x0032; 0x020d; 0x001c; 0x020d; 0x0046; 0x020d; 0x0058;
    0x020d; 0x0044; 0x020d; 0x002c; 0x020d; 0x0017; 0x020d; 0x000c;
    0x020d; 0x003a; 0x020d; 0x00e3; 0x020d; 0x0039; 0x020d; 0x0039;
    0x020d; 0x00de; 0x020d; 0x0029; 0x020d; 0x0028; 0x020d; 0x0049;
    0x020d; 0x00c8; 0x020d; 0x00b4; 0x020d; 0x0013; 0x020d; 0x0024;
    0x020d; 0x003a; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x002c;
    0x020d; 0x0026; 0x020d; 0x00d4; 0x020d; 0x001c; 0x020d; 0x002a;
    0x020d; 0x0034; 0x020d; 0x001d; 0x020d; 0x0026; 0x020d; 0x001d;
    0x020d; 0x009c; 0x020d; 0x0038; 0x020d; 0x0016; 0x020d; 0x000c;
    0x020d; 0x0038; 0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x0047;
    0x020d; 0x0030; 0x020d; 0x001a; 0x020d; 0x0015; 0x020d; 0x0020;
    0x020d; 0x003a; 0x020d; 0x0038; 0x020d; 0x0011; 0x020d; 0xfffc;
    0x020d; 0x001c; 0x020d; 0x000c; 0x020d; 0x0035; 0x020d; 0x0023;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0069; 0x020d; 0x001a;
    0x020d; 0x000c; 0x020d; 0x00ad; 0x020d; 0x0058; 0x020d; 0x0023;
    0x020d; 0x00c8; 0x020d; 0x0026; 0x020d; 0x0038; 0x020d; 0x0028;
    0x020d; 0x003e; 0x020d; 0x0081; 0x020d; 0x00d9; 0x020d; 0x0016;
    0x020d; 0x0020; 0x020d; 0x0034; 0x020d; 0x0048; 0x020d; 0x00b4;
    0x020d; 0x002c; 0x020d; 0x0035; 0x020d; 0x003a; 0x020d; 0x0000;
    0x020d; 0x001a; 0x020d; 0x0019; 0x020d; 0x002c; 0x020d; 0x0034;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0038; 0x020d; 0x0012;
    0x020d; 0x0018; 0x020d; 0x000b; 0x020d; 0x0010; 0x020d; 0x001b;
    0x020d; 0x001b; 0x020d; 0x0013; 0x020d; 0x001a; 0x020d; 0x0030;
    0x020d; 0x0021; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x009d; 0x0000; 0xfe90;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x0017; 0x020d; 0x0021;
    0x020d; 0x0017; 0x020d; 0x0021; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x001b;
    0x020d; 0x0032; 0x020d; 0x0026; 0x020d; 0x0095; 0x020d; 0x004b;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x001b; 0x020d; 0x0032;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x003b; 0x020d; 0x001d;
    0x020d; 0x001d; 0x020d; 0x003b; 0x020d; 0x0045; 0x020d; 0x001b;
    0x020d; 0x0032; 0x020d; 0x0017; 0x020d; 0x0017; 0x020d; 0x000c;
    0x020d; 0x0057; 0x0000; 0xfe4a; 0x0000; 0xfe4a; 0x0000; 0xfe4a;
    0x0000; 0xfe4a; 0x020d; 0x00e3; 0x020d; 0x007d; 0x020d; 0x0028;
    0x020d; 0x0049; 0x020d; 0x0072; 0x0000; 0xfe65; 0x020d; 0x0028;
    0x020d; 0x0049; 0x020d; 0x0028; 0x020d; 0x0049; 0x020d; 0x0028;
    0x020d; 0x0049; 0x020d; 0x0028; 0x020d; 0x0049; 0x020d; 0x00a2;
    0x020d; 0x0049; 0x020d; 0x0002; 0x020d; 0x001b; 0x020d; 0x0072;
    0x0000; 0xfe65; 0x020d; 0x0028; 0x0000; 0xfebb; 0x020d; 0x0000;
    0x020d; 0x005c; 0x020d; 0x0042; 0x020d; 0x0042; 0x020d; 0x0091;
    0x020d; 0x001d; 0x0000; 0xfe4e; 0x020d; 0x007b; 0x020d; 0x0013;
    0x020d; 0x0024; 0x020d; 0x0013; 0x020d; 0x0024; 0x020d; 0x0013;
    0x020d; 0x0024; 0x020d; 0x0075; 0x020d; 0x0022; 0x020d; 0x0026;
    0x020d; 0x0087; 0x0000; 0xfe7a; 0x020d; 0x003a; 0x020d; 0x0026;
    0x020d; 0xff30; 0x020d; 0x000b; 0x020d; 0x0024; 0x020d; 0x0022;
    0x020d; 0x00d5; 0x0000; 0xfec8; 0x0000; 0xfec8; 0x020d; 0x004e;
    0x020d; 0x0030; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x0019;
    0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x0038; 0x020d; 0x0038;
    0x020d; 0x000c; 0x020d; 0x002f; 0x020d; 0x001a; 0x020d; 0x0037;
    0x020d; 0x001a; 0x020d; 0x001a; 0x020d; 0x0037; 0x020d; 0x001f;
    0x020d; 0x0016; 0x020d; 0x0013; 0x020d; 0x0039; 0x020d; 0x001a;
    0x020d; 0x0037; 0x020d; 0x0037; 0x020d; 0x003e; 0x020d; 0x00d4;
    0x020d; 0x002a; 0x020d; 0x0046; 0x0000; 0xff40; 0x020d; 0x0026;
    0x020d; 0x001d; 0x020d; 0x0020; 0x020d; 0x0026; 0x020d; 0x001d;
    0x020d; 0x0026; 0x020d; 0x001d; 0x020d; 0x0026; 0x020d; 0x001d;
    0x020d; 0x0026; 0x020d; 0x001d; 0x020d; 0x0026; 0x020d; 0x001d;
    0x020d; 0x0011; 0x0000; 0xfe8f; 0x020d; 0x002f; 0x020d; 0x002e;
    0x020d; 0x0080; 0x020d; 0x0080; 0x020d; 0x0016; 0x020d; 0x000c;
    0x020d; 0x0016; 0x020d; 0x000c; 0x020d; 0x0016; 0x020d; 0x000c;
    0x020d; 0x0016; 0x020d; 0x000c; 0x020d; 0x0016; 0x020d; 0x000c;
    0x0000; 0xfe97; 0x020d; 0x005c; 0x0000; 0xfe4f; 0x020d; 0x004f;
    0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x004f;
    0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x004f;
    0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x004f;
    0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004f; 0x020d; 0x004e;
    0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004e;
    0x020d; 0x004a; 0x020d; 0x004a; 0x020d; 0x0027; 0x020d; 0x0030;
    0x020d; 0x004f; 0x020d; 0x004e; 0x020d; 0x004f; 0x020d; 0x004f;
    0x020d; 0x004e; 0x020d; 0x0030; 0x020d; 0x0047; 0x020d; 0x0030;
    0x020d; 0x001a; 0x020d; 0x001a; 0x020d; 0x0015; 0x020d; 0x0020;
    0x020d; 0x003a; 0x020d; 0x001d; 0x020d; 0x0020; 0x020d; 0x003a;
    0x020d; 0x0020; 0x020d; 0x003a; 0x020d; 0x0020; 0x020d; 0x003a;
    0x020d; 0x0020; 0x020d; 0x003a; 0x020d; 0xffdd; 0x020d; 0x001d;
    0x0000; 0xfe3d; 0x020d; 0x0012; 0x020d; 0x0026; 0x020d; 0x002a;
    0x020d; 0x001c; 0x020d; 0x003a; 0x020d; 0x004a; 0x0000; 0xfe3d;
    0x0000; 0xfe3d; 0x020d; 0xffa5; 0x020d; 0x0011; 0x020d; 0xfffc;
    0x020d; 0x0022; 0x020d; 0x0026; 0x020d; 0x0011; 0x020d; 0x000b;
    0x020d; 0x005c; 0x0282; 0x0028; 0x020d; 0x001c; 0x020d; 0x000c;
    0x020d; 0x001c; 0x020d; 0x0000; 0x020d; 0x001c; 0x020d; 0x000c;
    0x020d; 0x001c; 0x020d; 0x000c; 0x020d; 0x001c; 0x020d; 0x000c;
    0x020d; 0x001c; 0x020d; 0x000c; 0x020d; 0x001c; 0x020d; 0x000c;
    0x020d; 0x001c; 0x020d; 0xffeb; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x001d; 0x020d; 0x0013;
    0x020d; 0x00a1; 0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0020;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0038; 0x020d; 0x0039;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0020; 0x020d; 0x0038;
    0x020d; 0x001a; 0x020d; 0x001a; 0x020d; 0x00b2; 0x020d; 0x0038;
    0x020d; 0x0039; 0x020d; 0x007d; 0x020d; 0x0062; 0x020d; 0x0077;
    0x020d; 0x0038; 0x020d; 0x002b; 0x020d; 0x0038; 0x020d; 0x002b;
    0x020d; 0x0038; 0x020d; 0x0039; 0x020d; 0x0030; 0x020d; 0x00c8;
    0x020d; 0x002d; 0x020d; 0x001a; 0x020d; 0x0028; 0x020d; 0x0016;
    0x020d; 0x0026; 0x020d; 0x0026; 0x020d; 0x0000; 0x020d; 0x003e;
    0x020d; 0x0095; 0x020d; 0x007c; 0x020d; 0x0081; 0x020d; 0x0081;
    0x020d; 0x0081; 0x020d; 0x00b7; 0x020d; 0x00b4; 0x020d; 0x00da;
    0x020d; 0x0016; 0x020d; 0x0020; 0x020d; 0xfffc; 0x020d; 0x0016;
    0x020d; 0x0020; 0x020d; 0x0016; 0x020d; 0x0020; 0x020d; 0x0016;
    0x020d; 0x0020; 0x020d; 0x0016; 0x020d; 0x0020; 0x020d; 0x0016;
    0x020d; 0x0020; 0x020d; 0x0016; 0x020d; 0x0020; 0x020d; 0x0016;
    0x020d; 0x005c; 0x020d; 0x0000; 0x020d; 0x001a; 0x020d; 0x00a6;
    0x0000; 0xfe99; 0x020d; 0x0073; 0x020d; 0x0073; 0x020d; 0x0034;
    0x020d; 0x0048; 0x020d; 0x0034; 0x020d; 0x0048; 0x020d; 0x0034;
    0x020d; 0x0048; 0x020d; 0x0037; 0x020d; 0x0034; 0x020d; 0x0048;
    0x020d; 0x0034; 0x020d; 0x0048; 0x020d; 0x0034; 0x020d; 0x0048;
    0x020d; 0x0024; 0x020d; 0x0038; 0x020d; 0x0028; 0x020d; 0x0012;
    0x020d; 0x001a; 0x020d; 0x001a; 0x020d; 0x0019; 0x020d; 0x001a;
    0x020d; 0x0019; 0x020d; 0x001a; 0x020d; 0x0019; 0x020d; 0x0019;
    0x020d; 0x001a; 0x020d; 0x0019; 0x020d; 0x0038; 0x020d; 0x001f;
    0x020d; 0x000c; 0x020d; 0x0016; 0x020d; 0x009a; 0x0385; 0x00e3;
    0x020d; 0x0058; 0x0000; 0xfe4b; 0x0000; 0xfe4b; 0x020d; 0x001a;
    0x020d; 0x0019; 0x020d; 0x009e; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x0004; 0x020d; 0x000b;
    0x020d; 0x0004; 0x020d; 0x000b; 0x020d; 0x0004; 0x020d; 0x000b;
    0x020d; 0x0004; 0x020d; 0x000b; 0x020d; 0x0004; 0x020d; 0x000b;
    0x020d; 0x0004; 0x020d; 0x000b; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x0385; 0x00e3; 0x0385; 0x00e3;
    0x020d; 0x0039; 0x020d; 0x0039; 0x020d; 0x002c; 0x020d; 0x0004;
    0x020d; 0x000c; 0x020d; 0x0026; 0x020d; 0x0004; 0x020d; 0x000c;
    0x020d; 0x0004; 0x020d; 0x000c; 0x020d; 0x000b; 0x020d; 0x0010;
    0x020d; 0x000b; 0x020d; 0x0010; 0x020d; 0x000b; 0x020d; 0x0010;
    0x020d; 0x000b; 0x020d; 0x0010; 0x020d; 0x000b; 0x020d; 0x0021;
    0x020d; 0x0013; 0x020d; 0x001a; 0x020d; 0x0013; 0x020d; 0x001a;
    0x020d; 0x0013; 0x020d; 0x001a; 0x020d; 0x0013; 0x020d; 0x001a;
    0x020d; 0x0013; 0x020d; 0x0013; 0x020d; 0x001a; 0x020d; 0x0013;
    0x020d; 0x001a; 0x020d; 0x0013; 0x020d; 0x001a; 0x020d; 0x0030;
    0x020d; 0x0021; 0x020d; 0x0030; 0x020d; 0x0021; 0x020d; 0x0030;
    0x020d; 0x0021; 0x020d; 0x0030; 0x020d; 0x0021; 0x020d; 0x0030;
    0x020d; 0x009d; 0x0000; 0xfe90; 0x020d; 0x0057; 0x020d; 0x0057;
    0x020d; 0x0057; 0x020d; 0x0057; 0x020d; 0x0057; 0x0000; 0xfe4a;
    0x020d; 0x0057; 0x020d; 0x0057; 0x020d; 0x0057; 0x020d; 0x0057;
    0x020d; 0x0057; 0x020d; 0x0057; 0x0000; 0xfe4a; 0x020d; 0x0057;
    0x020d; 0x0057; 0x020d; 0x0074; 0x0000; 0xfe65; 0x020d; 0x0074;
    0x020d; 0x0074; 0x020d; 0x0074; 0x0000; 0xfe65; 0x020d; 0x0074;
    0x020d; 0x0074; 0x020d; 0x0074; 0x020d; 0x0074; 0x020d; 0x0058;
    0x020d; 0x0058; 0x020d; 0x00c8; 0x020d; 0x005b; 0x020d; 0x005b;
    0x0000; 0xfe4e; 0x020d; 0x0078; 0x020d; 0x0078; 0x020d; 0x0087;
    0x020d; 0x0074; 0x020d; 0x0074; 0x0000; 0xfe7a; 0x020d; 0x0078;
    0x020d; 0x0087; 0x020d; 0x00d5; 0x0000; 0xfec8; 0x020d; 0x009c;
    0x0000; 0xfe8f; 0x020d; 0x00a4; 0x020d; 0x00a4; 0x0000; 0xfe97;
    0x020d; 0x005c; 0x0000; 0xfe4f; 0x020d; 0x004a; 0x020d; 0x004a;
    0x020d; 0x00a2; 0x020d; 0x00a2; 0x020d; 0x004a; 0x0000; 0xfe3d;
    0x020d; 0x00a6; 0x020d; 0x009d; 0x020d; 0x009d; 0x0000; 0xfe99;
    0x020d; 0x0058; 0x020d; 0x0058; 0x0000; 0xfe4b; 0x020d; 0x00c2;
    0x020d; 0x001b; 0x020d; 0x0032; 0x020d; 0x0000; 0x020d; 0x0001;
    0x020d; 0x0041; 0x020d; 0x004c; 0x020d; 0x0000; 0x0000; 0x0000;
    0x0000; 0x0000; 0x0000; 0x0000; 0x020d; 0x0057; 0x001d; 0x006f;
    0x00d5; 0x001a; 0x0037; 0x003e; 0x0074; 0x0026; 0x0071; 0x00af;
    0x0038; 0x00af; 0x004f; 0x004e; 0x0047; 0x0047; 0x0030; 0xffdf;
    0x0039; 0x0038; 0x0039; 0x003e; 0x00b0; 0x0081; 0x00b7; 0x0081;
    0x0081; 0x0081; 0x004b; 0x00d9; 0x00d9; 0x0069; 0x00e3; 0x005b;
    0x00e3; 0x0083; 0x0058; 0x0000; 0x0004; 0x000c; 0x0016; 0x000c;
    0x004f; 0x004e; 0xffe1; 0x003a; 0x0038; 0x0039; 0x001a; 0x001a;
    0x000d; 0x00d5; 0x0049; 0x002f; 0x0030; 0x002c; 0x0034; 0x001d;
    0x0035; 0x0069; 0x002c; 0x0035; 0x0000; 0x002c; 0x002f; 0x0028;
    0x0032;
  ]


let test_cases =
  [
    (700, Some((525, 166)));
    (780, Some((525, 53)));
    (785, Some((525, 50)));
    (786, None);
    (800, None);
  ]
